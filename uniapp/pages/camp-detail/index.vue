<template>
  <view class="page">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <view class="header">
      <text class="back" @tap="goBack">â€¹</text>
      <text class="title">å…è´¹ä½“éªŒæ´»åŠ¨è¯¦æƒ…</text>
    </view>

    <!-- ä¸»å›¾ -->
    <image src="/static/img_41.jpg" class="banner" mode="aspectFill" />

    <!-- å†…å®¹åŒº -->
    <scroll-view scroll-y class="content">
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="info-card">
        <text class="camp-title">è›™æ³³/è‡ªç”±æ³³(ä½“éªŒè¯¾)</text>
        <view class="price-row">
          <view class="price-left">
            <text class="price-current">ï¿¥0</text>
            <text class="price-original">ï¿¥280</text>
          </view>
          <text class="quota">ğŸ—ºï¸ 50ä¸ªä¸­å¥–åé¢</text>
        </view>
        <view class="stats">
          <text class="stat">14671äººå·²æŠ¥å</text>
          <text class="stat">33936äººæ„Ÿå…´è¶£</text>
        </view>
      </view>

      <!-- æ•™ç»ƒä¿¡æ¯ -->
      <view class="section">
        <text class="section-title">é€‚ç”¨æ•™ç»ƒå¸ˆ</text>
        <view class="coach-card">
          <image src="/static/img-13.jpg" class="coach-avatar" mode="aspectFill" />
          <view class="coach-info">
            <view class="coach-header">
              <text class="coach-name">æè€å¸ˆ</text>
              <view class="coach-tags">
                <text class="tag">ä½“è‚²è¯¾</text>
                <text class="tag">æ¸¸æ³³æ•™å­¦</text>
              </view>
            </view>
            <text class="rating">â­â­â­â­â˜†</text>
            <text class="location">ğŸ“ 1km å¸‚åŒºé™„è¿‘</text>
          </view>
        </view>
      </view>

      <!-- æ ‡ç­¾æ  -->
      <view class="tabs">
        <view v-for="(tab, idx) in tabs" :key="idx" :class="['tab', { active: activeTab === idx }]" @tap="activeTab = idx">
          {{ tab }}
        </view>
      </view>

      <!-- æ´»åŠ¨æµç¨‹ -->
      <view v-if="activeTab === 0" class="tab-content">
        <image src="/static/hd-steps-banner.png" class="flow-img" mode="widthFix" />
      </view>

      <!-- æ´»åŠ¨å†…å®¹ -->
      <view v-if="activeTab === 1" class="tab-content">
        <view class="item-row">
          <text class="label">è¯¾ç¨‹å†…å®¹ï¼š</text>
          <text class="value">è›™æ³³/è‡ªç”±æ³³ä½“éªŒ</text>
        </view>
        <view class="item-row">
          <text class="label">å®¹çº³äººæ•°ï¼š</text>
          <text class="value">1äºº</text>
        </view>
        <view class="item-row">
          <text class="label">å®¹çº³æ—¶é—´ï¼š</text>
          <text class="value">40åˆ†é’Ÿ</text>
        </view>
        <view class="item-row">
          <text class="label">ä½“éªŒæ¬¡æ•°ï¼š</text>
          <text class="value">ä»…é™å•æ¬¡ä½“éªŒå®Œæ¯•</text>
        </view>
        <view class="item-row">
          <text class="label">é€‚ç”¨å¹´é¾„ï¼š</text>
          <text class="value">ä¸é™ï¼Œå°æœ‹å‹é€‚ç”¨</text>
        </view>
        <view class="notice">
          <text class="notice-icon">âš ï¸</text>
          <text class="notice-text">å…è´¹ä½“éªŒåªé™å¯¹å¹´é¾„ä»¥ä¸Šå†…å®¹ï¼Œå…¶ä»–è¯¾ç¨‹è¯·è¯¢é—®å®¢æœ</text>
        </view>
      </view>

      <!-- æ´»åŠ¨è§„åˆ™ -->
      <view v-if="activeTab === 2" class="tab-content">
        <view class="rule-section">
          <text class="rule-title">ä½“éªŒæ—¶é—´</text>
          <view class="rule-item">
            <text class="rule-label">ä½“éªŒæ—¥æœŸï¼š</text>
            <text class="rule-value">2025å¹´10æœˆ11æ—¥ - 2025å¹´11æœˆ30æ—¥</text>
          </view>
          <view class="rule-item">
            <text class="rule-label">ä½¿ç”¨æ—¶é—´ï¼š</text>
            <text class="rule-value">åŒç½‘ç«™æ­£å¼ä¸Šçº¿åå¼€å§‹</text>
          </view>
        </view>
        <view class="rule-section">
          <text class="rule-title">é¢„çº¦è§„åˆ™</text>
          <text class="rule-desc">â€¢ è¯·åœ¨çº¦å®šç¬¬ä¸€æ¬¡æ—¶é—´å‰è”ç³»å®¢æœï¼Œè‹¥æœªèƒ½åœ¨çº¦å®šæ—¶é—´å†…è¿›è¡Œè¯¾ç¨‹çš„ä½“éªŒï¼Œè¯¾ç¨‹æ­¤æ¬¡ä½“éªŒæœåŠ¡ä½“éªŒã€‚</text>
          <text class="rule-desc">â€¢ å•æ¬¡ä½“éªŒçš„è¯¾ç¨‹ç½‘ä¸­æ„åˆæ³•è”ç³»å…³ç³»å¤§æ­¤é‡çš„ï¼Œæ—¶æœªèƒ½ä¿éšœçš„å®¢æœè”ç³»ã€‚</text>
        </view>
        <view class="rule-section">
          <text class="rule-title">é™å‘Šé¡»çŸ¥</text>
          <text class="rule-desc">â€¢ å…è´¹ä½“éªŒè¯¾ç¨‹ä¸ä½äºå›å®¶æœåŠ¡åœ°ç‚¹ã€‚</text>
          <text class="rule-desc">â€¢ ä¸å¾—åˆ©ç”¨ä½“éªŒçš„æœºä¼šè¿›è¡Œå…¶ä»–å•†ä¸šæ´»åŠ¨ï¼Œä¸€ç»å‘ç°å³å¯å–æ¶ˆæœ¬æ¬¡ä½“éªŒæœºä¼šã€‚</text>
        </view>
      </view>
    </scroll-view>

    <!-- åº•éƒ¨æ“ä½œæ  -->
    <view class="footer">
      <view class="countdown">
        <text class="countdown-label">è·æŠ¥åæˆªè‡³æ—¶é—´ï¼š</text>
        <text class="countdown-text">{{ countdown }}</text>
      </view>
      <view class="btn-register" @tap="register">æˆ‘è¦æŠ¥å</view>
    </view>
  </view>
</template>

<script>
export default {
  data() {
    return {
      campId: '',
      activeTab: 0,
      tabs: ['æ´»åŠ¨æµç¨‹', 'æ´»åŠ¨å†…å®¹', 'æ´»åŠ¨è§„åˆ™'],
      countdown: '',
      timer: null,
      endTime: null
    }
  },
  onLoad(options) {
    this.campId = options.id || '1'
    this.endTime = Date.now() + 10 * 24 * 60 * 60 * 1000 + 22 * 60 * 60 * 1000
    this.startCountdown()
  },
  onUnload() {
    if (this.timer) clearInterval(this.timer)
  },
  methods: {
    goBack() { uni.navigateBack() },
    startCountdown() {
      this.updateCountdown()
      this.timer = setInterval(() => { this.updateCountdown() }, 1000)
    },
    updateCountdown() {
      const now = Date.now()
      const distance = this.endTime - now
      if (distance < 0) {
        this.countdown = 'å·²ç»“æŸ'
        clearInterval(this.timer)
        return
      }
      const days = Math.floor(distance / (1000 * 60 * 60 * 24))
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60))
      const seconds = Math.floor((distance % (1000 * 60)) / 1000)
      this.countdown = `${days}å¤©${String(hours).padStart(2, '0')}å°æ—¶${String(minutes).padStart(2, '0')}åˆ†${String(seconds).padStart(2, '0')}ç§’`
    },
    register() {
      uni.showModal({
        title: 'æŠ¥åæˆåŠŸ',
        content: 'æˆ‘ä»¬å°†å°½å¿«ä¸æ‚¨è”ç³»',
        showCancel: false
      })
    }
  }
}
</script>

<style lang="scss" scoped>
.page { background: #f5f5f5; min-height: 100vh; display: flex; flex-direction: column; }
.header { position: fixed; top: 0; left: 0; right: 0; z-index: 99; background: #fff; display: flex; align-items: center; padding: calc(var(--status-bar-height) + 20rpx) 30rpx 20rpx; border-bottom: 1rpx solid #f0f0f0; }
.back { width: 48rpx; height: 48rpx; display: flex; align-items: center; justify-content: center; font-size: 40rpx; color: #333; margin-right: 20rpx; }
.title { font-size: 32rpx; font-weight: 700; color: #222; flex: 1; }
.banner { width: 100%; height: 400rpx; margin-top: calc(var(--status-bar-height) + 100rpx); }
.content { flex: 1; padding-bottom: 180rpx; }
.info-card { background: #fff; padding: 30rpx; margin-bottom: 20rpx; }
.camp-title { display: block; font-size: 36rpx; font-weight: 700; color: #222; margin-bottom: 30rpx; }
.price-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20rpx; }
.price-left { display: flex; align-items: baseline; gap: 16rpx; }
.price-current { font-size: 48rpx; font-weight: 700; color: #ff6b35; }
.price-original { font-size: 28rpx; color: #999; text-decoration: line-through; }
.quota { background: #fff3cd; color: #856404; padding: 8rpx 16rpx; border-radius: 8rpx; font-size: 24rpx; }
.stats { display: flex; gap: 32rpx; padding-top: 20rpx; border-top: 1rpx solid #f5f5f5; }
.stat { font-size: 24rpx; color: #666; }
.section { background: #fff; padding: 30rpx; margin-bottom: 20rpx; }
.section-title { display: block; font-size: 30rpx; font-weight: 700; color: #222; margin-bottom: 30rpx; }
.coach-card { display: flex; gap: 24rpx; }
.coach-avatar { width: 120rpx; height: 120rpx; border-radius: 50%; }
.coach-info { flex: 1; }
.coach-header { display: flex; align-items: center; gap: 20rpx; margin-bottom: 16rpx; }
.coach-name { font-size: 28rpx; font-weight: 700; color: #222; }
.coach-tags { display: flex; gap: 12rpx; }
.tag { background: #fff3e0; color: #f57c00; padding: 4rpx 16rpx; border-radius: 16rpx; font-size: 20rpx; }
.rating { display: block; font-size: 24rpx; color: #ffc107; margin-bottom: 12rpx; }
.location { display: block; font-size: 20rpx; color: #999; }
.tabs { display: flex; background: #fff; border-bottom: 1rpx solid #f0f0f0; }
.tab { flex: 1; text-align: center; padding: 30rpx 0; font-size: 28rpx; color: #666; position: relative; &.active { color: #222; font-weight: 700; &::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 48rpx; height: 4rpx; background: #ff6b35; border-radius: 2rpx; } } }
.tab-content { background: #fff; padding: 30rpx; margin-bottom: 20rpx; }
.flow-img { width: 100%; }
.item-row { display: flex; margin-bottom: 24rpx; }
.label { font-size: 26rpx; color: #666; min-width: 160rpx; }
.value { font-size: 26rpx; color: #333; flex: 1; }
.notice { display: flex; align-items: flex-start; gap: 16rpx; padding: 24rpx; background: #fff3cd; border-left: 4rpx solid #ffc107; border-radius: 8rpx; margin-top: 30rpx; }
.notice-icon { font-size: 32rpx; }
.notice-text { font-size: 24rpx; color: #856404; line-height: 1.6; flex: 1; }
.rule-section { margin-bottom: 40rpx; &:last-child { margin-bottom: 0; } }
.rule-title { display: block; font-size: 32rpx; font-weight: 700; color: #222; margin-bottom: 24rpx; }
.rule-item { display: flex; margin-bottom: 16rpx; }
.rule-label { font-size: 26rpx; color: #666; min-width: 160rpx; }
.rule-value { font-size: 26rpx; color: #333; flex: 1; }
.rule-desc { display: block; font-size: 26rpx; color: #666; line-height: 1.8; margin-bottom: 16rpx; }
.footer { position: fixed; bottom: 0; left: 0; right: 0; background: #fff; padding: 20rpx 30rpx; padding-bottom: calc(20rpx + env(safe-area-inset-bottom)); display: flex; align-items: center; gap: 20rpx; border-top: 1rpx solid #f0f0f0; }
.countdown { flex: 1; }
.countdown-label { display: block; font-size: 22rpx; color: #666; margin-bottom: 8rpx; }
.countdown-text { display: block; font-size: 26rpx; color: #333; font-weight: 700; }
.btn-register { background: linear-gradient(90deg, #ffa726, #ffb74d); color: #fff; padding: 24rpx 60rpx; border-radius: 48rpx; font-size: 28rpx; font-weight: 700; }
</style>
