# ğŸš€ å¼€å§‹éƒ¨ç½² - å®Œæ•´æµç¨‹

## ğŸ“‹ éƒ¨ç½²æ¸…å•

- âœ… æœåŠ¡å™¨ IP: `49.235.120.150`
- âœ… åŸŸå: `https://hss.daozishule.cn`
- âœ… å‰ç«¯è·¯å¾„: `/var/www/projects/hxs-demo/dist`
- âœ… SSL è¯ä¹¦: å·²é…ç½®ï¼ˆLet's Encryptï¼‰
- â³ åç«¯æœåŠ¡: å¾…éƒ¨ç½²
- â³ Nginx é…ç½®: éœ€è¦æ·»åŠ  TTS ä»£ç†

## ğŸ¯ éƒ¨ç½²æ­¥éª¤ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰

### æ­¥éª¤ 1: éƒ¨ç½²ä»£ç åˆ°æœåŠ¡å™¨

åœ¨æœ¬åœ°è¿è¡Œï¼š

```bash
./deploy-to-server.sh
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ„å»ºå‰ç«¯
- âœ… ä¸Šä¼ å‰ç«¯æ–‡ä»¶åˆ°æœåŠ¡å™¨
- âœ… ä¸Šä¼ åç«¯æ–‡ä»¶åˆ°æœåŠ¡å™¨
- âœ… å®‰è£…ä¾èµ–ï¼ˆpnpmã€PM2ï¼‰
- âœ… å¯åŠ¨ TTS ä»£ç†æœåŠ¡

**é¢„è®¡æ—¶é—´**: 2-3 åˆ†é’Ÿ

---

### æ­¥éª¤ 2: æ›´æ–° Nginx é…ç½®

#### æ–¹æ³• A: æ‰‹åŠ¨æ›´æ–°ï¼ˆæ¨èï¼‰

1. SSH ç™»å½•æœåŠ¡å™¨ï¼š
```bash
ssh root@49.235.120.150
```

2. ç¼–è¾‘ Nginx é…ç½®ï¼š
```bash
sudo nano /etc/nginx/sites-available/hss.daozishule.cn
```

3. åœ¨ `location / { ... }` å—**ä¹‹å**æ·»åŠ ï¼š

```nginx
    # TTS API ä»£ç†
    location /api/tts {
        proxy_pass http://localhost:3001/api/tts;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_buffering off;
        proxy_cache off;
        proxy_set_header X-Accel-Buffering no;
        chunked_transfer_encoding on;
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
```

4. ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+O, Enter, Ctrl+Xï¼‰

5. æµ‹è¯•é…ç½®ï¼š
```bash
sudo nginx -t
```

6. é‡å¯ Nginxï¼š
```bash
sudo systemctl restart nginx
```

#### æ–¹æ³• B: æŸ¥çœ‹è¯¦ç»†è¯´æ˜

```bash
cat nginx-update-instructions.md
```

**é¢„è®¡æ—¶é—´**: 2 åˆ†é’Ÿ

---

### æ­¥éª¤ 3: éªŒè¯éƒ¨ç½²

#### 3.1 æ£€æŸ¥åç«¯æœåŠ¡

SSH åˆ°æœåŠ¡å™¨ï¼š
```bash
ssh root@49.235.120.150
```

æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š
```bash
pm2 status
```

åº”è¯¥çœ‹åˆ° `tts-proxy` æœåŠ¡çŠ¶æ€ä¸º `online`ã€‚

æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
pm2 logs tts-proxy --lines 20
```

#### 3.2 æµ‹è¯• TTS API

åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•ï¼š
```bash
curl -X POST https://hss.daozishule.cn/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text":"ä½ å¥½","voice":"Cherry","language_type":"Chinese"}'
```

åº”è¯¥çœ‹åˆ°æµå¼è¿”å›çš„éŸ³é¢‘æ•°æ®ã€‚

#### 3.3 æµ‹è¯•å‰ç«¯

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®: https://hss.daozishule.cn
2. è¿›å…¥ AI æ™ºèƒ½ä½“é¡µé¢
3. ç‚¹å‡»å³ä¸Šè§’é½¿è½®å›¾æ ‡æ‰“å¼€è®¾ç½®
4. é€‰æ‹©ä¸€ä¸ªéŸ³è‰²
5. å‘é€æ¶ˆæ¯æµ‹è¯•
6. æ£€æŸ¥æ˜¯å¦èƒ½å¬åˆ°è¯­éŸ³æ’­æ”¾

**é¢„è®¡æ—¶é—´**: 3 åˆ†é’Ÿ

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] å‰ç«¯æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆ`pm2 status` æ˜¾ç¤º onlineï¼‰
- [ ] Nginx é…ç½®å·²æ›´æ–°
- [ ] Nginx å·²é‡å¯ä¸”æ— é”™è¯¯
- [ ] TTS API å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] å‰ç«¯é¡µé¢å¯ä»¥æ­£å¸¸æ‰“å¼€
- [ ] AI å¯¹è¯åŠŸèƒ½æ­£å¸¸
- [ ] è¯­éŸ³æ’­æ”¾åŠŸèƒ½æ­£å¸¸

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹åç«¯æœåŠ¡çŠ¶æ€
```bash
ssh root@49.235.120.150 "pm2 status"
```

### æŸ¥çœ‹åç«¯æ—¥å¿—
```bash
ssh root@49.235.120.150 "pm2 logs tts-proxy --lines 50"
```

### é‡å¯åç«¯æœåŠ¡
```bash
ssh root@49.235.120.150 "pm2 restart tts-proxy"
```

### æŸ¥çœ‹ Nginx æ—¥å¿—
```bash
ssh root@49.235.120.150 "sudo tail -f /var/log/nginx/error.log"
```

### é‡æ–°éƒ¨ç½²ï¼ˆä»£ç æ›´æ–°åï¼‰
```bash
./deploy-to-server.sh
```

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: éƒ¨ç½²è„šæœ¬å¤±è´¥

**ç—‡çŠ¶**: `./deploy-to-server.sh` æ‰§è¡Œå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ SSH è¿æ¥: `ssh root@49.235.120.150`
2. æ£€æŸ¥æœ¬åœ°æ˜¯å¦å·²æ„å»º: `pnpm build`
3. æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œæ ¹æ®æç¤ºè§£å†³

### é—®é¢˜ 2: TTS æ— æ³•æ’­æ”¾

**ç—‡çŠ¶**: å‰ç«¯æ˜¾ç¤º"æ­£åœ¨ç”Ÿæˆè¯­éŸ³..."ä½†æ²¡æœ‰å£°éŸ³

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥åç«¯æœåŠ¡:
   ```bash
   ssh root@49.235.120.150 "pm2 status"
   ```

2. æŸ¥çœ‹åç«¯æ—¥å¿—:
   ```bash
   ssh root@49.235.120.150 "pm2 logs tts-proxy"
   ```

3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

4. æµ‹è¯• API:
   ```bash
   curl -X POST https://hss.daozishule.cn/api/tts \
     -H "Content-Type: application/json" \
     -d '{"text":"æµ‹è¯•","voice":"Cherry","language_type":"Chinese"}'
   ```

### é—®é¢˜ 3: 502 Bad Gateway

**ç—‡çŠ¶**: è®¿é—® `/api/tts` è¿”å› 502 é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤åç«¯æœåŠ¡è¿è¡Œ: `pm2 status`
2. ç¡®è®¤ç«¯å£ 3001 æœªè¢«å ç”¨: `sudo netstat -tlnp | grep 3001`
3. é‡å¯åç«¯æœåŠ¡: `pm2 restart tts-proxy`
4. æ£€æŸ¥ Nginx é…ç½®: `sudo nginx -t`

### é—®é¢˜ 4: å‰ç«¯æ›´æ–°æœªç”Ÿæ•ˆ

**ç—‡çŠ¶**: ä»£ç æ›´æ–°åï¼Œæµè§ˆå™¨çœ‹åˆ°çš„è¿˜æ˜¯æ—§ç‰ˆæœ¬

**è§£å†³æ–¹æ¡ˆ**:
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl+Shift+R æˆ– Cmd+Shift+Rï¼‰
2. ä½¿ç”¨æ— ç—•æ¨¡å¼è®¿é—®
3. æ£€æŸ¥æœåŠ¡å™¨æ–‡ä»¶æ˜¯å¦æ›´æ–°:
   ```bash
   ssh root@49.235.120.150 "ls -la /var/www/projects/hxs-demo/dist"
   ```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **QUICK-DEPLOY.md** - å¿«é€Ÿéƒ¨ç½²æŒ‡å—
- **nginx-update-instructions.md** - Nginx é…ç½®è¯¦ç»†è¯´æ˜
- **DEPLOYMENT.md** - å®Œæ•´éƒ¨ç½²æ–‡æ¡£
- **deploy-to-server.sh** - è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
- **update-nginx.sh** - Nginx é…ç½®æ›´æ–°åŠ©æ‰‹

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸï¼

å¦‚æœæ‰€æœ‰æ­¥éª¤éƒ½å®Œæˆä¸”æµ‹è¯•é€šè¿‡ï¼Œæ­å–œä½ ï¼ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²ã€‚

ç°åœ¨ä½ å¯ä»¥ï¼š
- âœ… è®¿é—® https://hss.daozishule.cn ä½¿ç”¨åº”ç”¨
- âœ… ä¸ AI å¯¹è¯å¹¶å¬åˆ°è¯­éŸ³å›å¤
- âœ… é€‰æ‹©ä¸åŒçš„éŸ³è‰²
- âœ… äº«å—æµç•…çš„ç”¨æˆ·ä½“éªŒ

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ç›¸å…³æ–‡æ¡£
2. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
3. è¿è¡Œæ•…éšœæ’æŸ¥å‘½ä»¤
4. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€
